{"remainingRequest":"C:\\Users\\yujing\\Desktop\\vue\\Admin\\tt-shop\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\yujing\\Desktop\\vue\\Admin\\tt-shop\\src\\request\\https.js","dependencies":[{"path":"C:\\Users\\yujing\\Desktop\\vue\\Admin\\tt-shop\\src\\request\\https.js","mtime":1597732314971},{"path":"C:\\Users\\yujing\\Desktop\\vue\\Admin\\tt-shop\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\yujing\\Desktop\\vue\\Admin\\tt-shop\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnJlZ2V4cC5leGVjIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLnJlcGxhY2UiOwppbXBvcnQgVnVlIGZyb20gJ3Z1ZSc7CmltcG9ydCBheGlvcyBmcm9tICdheGlvcyc7CmltcG9ydCBzdG9yZSBmcm9tICIuLi9zdG9yZSI7CmltcG9ydCByb3V0ZXIgZnJvbSAnLi4vcm91dGVyJzsgLy8gMS7phY3nva5wb3N06K+35rGC5Y+C5pWw77yMdXJs77yM6K+35rGC5Y+C5pWw77yM6buY6K6k6YWN572u6aG5LOWIpOaWrXRva2Vu5aaC5p6c5a2Y5Zyo77yM5YiZ5ou/552AdG9rZW7lj5HpgIHor7fmsYLvvIzkuI3lrZjlnKjliJnot7PovaznmbvlvZXpobUKLy8gMi7lsIHoo4Vwb3N06K+35rGC5oum5oiq77yM6buY6K6k57uZcG9zdOivt+axguWKoOS4iuivt+axguWktO+8jOWjsOaYjuWGheWuueagvOW8j++8jOi/mOacie+8mu+8jOS7peWPiumqjOivgXRva2Vu5pyJ5pWI5oCnCi8vIDMu5bCB6KOFcG9zdOWTjeW6lOaLpuaIqu+8jOWIpOaWrWNvZGXnoIHkuI3miJDlip/nmoTmg4XlhrXvvIzliIbliKvot7PovazkuI3lkIznmoTpobXpnaLvvIxsb2dpbu+8jDQwNOetie+8jOiOt+WPlueahOacgOaWsOeahHRva2Vu5bm25LiU5pu05paw5o6J44CCCgpleHBvcnQgZnVuY3Rpb24gcG9zdCh1cmwsIHBhcmFtcywgX2NvbmZpZykgewogIHZhciBjb25maWcgPSBPYmplY3QuYXNzaWduKHsKICAgIHRva2VuOiB0cnVlLAogICAgLy/pu5jorqTkuI3pnIDopoF0b2tlbuWPguaVsAogICAgY2hlY2s6IHRydWUsCiAgICAvL+m7mOiupOimgeWIpOaWrei/lOWbnueahOeKtuaAgSwKICAgIHJlc3BvbnNlVHlwZTogJ2pzb24nCiAgfSwgX2NvbmZpZyk7CgogIGlmIChjb25maWcudG9rZW4pIHsKICAgIGlmIChzdG9yZS5nZXR0ZXJzLmdldFRva2VuICE9IGZhbHNlKSB7CiAgICAgIHBhcmFtcy50b2tlbiA9IHN0b3JlLmdldHRlcnMuZ2V0VG9rZW47CiAgICB9IGVsc2UgewogICAgICByZXR1cm4gcm91dGVyLnJlcGxhY2UoewogICAgICAgIHBhdGg6ICcvbG9naW4nCiAgICAgIH0pOwogICAgfQogIH0KCiAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKICAgIGF4aW9zLnBvc3QodXJsLCBwYXJhbXMsIHsKICAgICAgcmVzcG9uc2VUeXBlOiBjb25maWcucmVzcG9uc2VUeXBlLAogICAgICBoZWFkZXJzOiB7CiAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJwogICAgICB9LAogICAgICB0cmFuc2Zvcm1SZXF1ZXN0OiBbZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICBkYXRhID0gSlNPTi5zdHJpbmdpZnkoZGF0YSk7CiAgICAgICAgcmV0dXJuIGRhdGE7CiAgICAgIH1dCiAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgaWYgKHJlcy5oZWFkZXJzLnRva2VuKSB7CiAgICAgICAgLy90b2tlbiwgIOeUqOaIt+i6q+S7veWHreivgQogICAgICAgIHN0b3JlLmRpc3BhdGNoKCJzZXRUb2tlbiIsIHJlcy5oZWFkZXJzLnRva2VuKTsKICAgICAgfQoKICAgICAgaWYgKGNvbmZpZy5jaGVjaykgewogICAgICAgIGlmIChyZXMuZGF0YS5jb2RlICE9IDEpIHsKICAgICAgICAgIHN3aXRjaCAocmVzLmRhdGEuY29kZSkgewogICAgICAgICAgICBjYXNlIDEwMDI6CiAgICAgICAgICAgIGNhc2UgMTAwMzoKICAgICAgICAgICAgICBWdWUucHJvdG90eXBlLiRtZXNzYWdlLmVycm9yKHsKICAgICAgICAgICAgICAgIG1lc3NhZ2U6IHJlcy5kYXRhLm1zZyB8fCAn5pyq55+l6ZSZ6K+vJywKICAgICAgICAgICAgICAgIG9uQ2xvc2U6IGZ1bmN0aW9uIG9uQ2xvc2UoKSB7CiAgICAgICAgICAgICAgICAgIHN0b3JlLmRpc3BhdGNoKCJzZXRUb2tlbiIsIGZhbHNlKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgMzAwMToKICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgIHJvdXRlci5nbygtMSk7CiAgICAgICAgICAgICAgfSwgMTAwMCk7CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgIFZ1ZS5wcm90b3R5cGUuJG1lc3NhZ2UuZXJyb3IoewogICAgICAgICAgICAgICAgbWVzc2FnZTogcmVzLmRhdGEubXNnIHx8ICfmnKrnn6XplJnor68nCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHJlc29sdmUocmVzLmRhdGEpOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICByZXNvbHZlKHJlcy5kYXRhKTsKICAgICAgfQogICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycikgewogICAgICAvLyDplJnor6/mjZXojrcKICAgICAgLy8gcmVqZWN0KGVyci5kYXRhKQogICAgICBWdWUucHJvdG90eXBlLiRtZXNzYWdlLmVycm9yKHsKICAgICAgICBtZXNzYWdlOiAn6K+35rGC5pyN5Yqh5Zmo5aSx6LSlJwogICAgICB9KTsKICAgIH0pOwogIH0pOwp9CmV4cG9ydCBmdW5jdGlvbiBnZXQodXJsLCBwYXJhbXMpIHsKICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgYXhpb3MuZ2V0KHVybCwgcGFyYW1zKS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgcmVzb2x2ZShyZXMuZGF0YSk7CiAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyKSB7CiAgICAgIHJlamVjdChlcnIuZGF0YSk7CiAgICB9KTsKICB9KTsKfQ=="},{"version":3,"sources":["C:/Users/yujing/Desktop/vue/Admin/tt-shop/src/request/https.js"],"names":["Vue","axios","store","router","post","url","params","_config","config","Object","assign","token","check","responseType","getters","getToken","replace","path","Promise","resolve","reject","headers","transformRequest","data","JSON","stringify","then","res","dispatch","code","prototype","$message","error","message","msg","onClose","setTimeout","go","catch","err","get"],"mappings":"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","sourcesContent":["import Vue from 'vue'\r\nimport axios from 'axios';\r\nimport store from \"../store\";\r\nimport router from '../router';\r\n\r\n// 1.配置post请求参数，url，请求参数，默认配置项,判断token如果存在，则拿着token发送请求，不存在则跳转登录页\r\n// 2.封装post请求拦截，默认给post请求加上请求头，声明内容格式，还有：，以及验证token有效性\r\n// 3.封装post响应拦截，判断code码不成功的情况，分别跳转不同的页面，login，404等，获取的最新的token并且更新掉。\r\nexport function post(url, params, _config) {\r\n  let config = Object.assign({\r\n    token: true, //默认不需要token参数\r\n    check: true, //默认要判断返回的状态,\r\n    responseType: 'json'\r\n  }, _config);\r\n  if (config.token) {\r\n    if (store.getters.getToken != false) {\r\n      params.token = store.getters.getToken\r\n    } else {\r\n      return router.replace({\r\n        path: '/login'\r\n      });\r\n    }\r\n  }\r\n  return new Promise((resolve, reject) => {\r\n    axios.post(url, params, {\r\n      responseType: config.responseType, headers: {\r\n        'Content-Type': 'application/json'\r\n      }, transformRequest: [function (data) {\r\n        data = JSON.stringify(data)\r\n        return data\r\n      }],\r\n    })\r\n      .then(res => {\r\n        if (res.headers.token) {     //token,  用户身份凭证\r\n          store.dispatch(\"setToken\", res.headers.token)\r\n        }\r\n        if (config.check) {\r\n          if (res.data.code != 1) {\r\n            switch (res.data.code) {\r\n              case 1002:\r\n              case 1003:\r\n                Vue.prototype.$message.error({\r\n                  message: res.data.msg || '未知错误',\r\n                  onClose() {\r\n                    store.dispatch(\"setToken\", false)\r\n                  }\r\n                });\r\n                break;\r\n              case 3001:\r\n                setTimeout(() => {\r\n                  router.go(-1);\r\n                }, 1000)\r\n                break;\r\n              default:\r\n                Vue.prototype.$message.error({\r\n                  message: res.data.msg || '未知错误'\r\n                });\r\n            }\r\n          } else {\r\n            resolve(res.data);\r\n          }\r\n        } else {\r\n          resolve(res.data);\r\n        }\r\n      })\r\n      .catch(err => {\r\n        // 错误捕获\r\n        // reject(err.data)\r\n        Vue.prototype.$message.error({\r\n          message: '请求服务器失败'\r\n        });\r\n      })\r\n  });\r\n}\r\n\r\nexport function get(url, params) {\r\n  return new Promise((resolve, reject) => {\r\n    axios.get(url, params)\r\n      .then(res => {\r\n        resolve(res.data);\r\n      })\r\n      .catch(err => {\r\n        reject(err.data)\r\n      })\r\n  });\r\n}\r\n"]}]}